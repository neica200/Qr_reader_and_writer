# **BitScanner**

## **Team Members**
- **Neica Mario-Alexandru** (134)
- **Roibu Amelia-Maria** (134)
- **Danila Tudor-Mihail** (134)
- **Draghici Bianca-Elena** (134)

---

## **Program Description**
When the program initializes, the user has to choose between two modes: **Reading Mode** or **Generation Mode** (1 or 2).

### **QR Code Generation Mode**
If the user selects the QR code generation mode, they need to enter a character string. The program processes the input string as follows:

1. **String Processing:**
   - The program calculates the length of the string.
   - Each character is converted into an 8-bit sequence corresponding to its ASCII code.
   
2. **QR Code Formatting:**
   - The first 4 bits are set to `0100` (Byte Mode).
   - The next 8 bits store the string length.
   - The user data is appended, followed by padding bits.
   - The data is split into 8-bit blocks (codewords).

3. **Error Correction:**
   - Using the **Reed-Solomon algorithm**, error-correcting codewords are generated.
   - The program uses **L-mode**, which allows for up to 7% data recovery.

4. **Matrix Construction:**
   - A binary matrix (0s and 1s) is created.
   - Finder patterns, separators, timing patterns, and alignment patterns (for version 2+) are placed.
   - These areas are marked to prevent alterations.
   - The data, length, and error correction codewords are placed in a **zig-zag pattern**, starting from the bottom-right corner.

5. **Masking and Formatting:**
   - All **8 masks** are applied, and a penalty score is calculated for each.
   - The mask with the **lowest penalty score** is selected.
   - Format codes are added, including:
     - `01` (L Mode)
     - 3 bits representing the selected mask
     - 10 BCH-encoded bits for error detection.

6. **QR Code Output:**
   - The QR code is generated as a PNG image using the **matplotlib.pyplot** library.
   
**Example Output:** QR code for the team name.
<img src=https://github.com/neica200/Qr_reader_and_writer/blob/main/qr_test.png height="300px">
---

### **QR Code Reading Mode**
If the user selects the QR code reading mode, they need to provide the filename of the QR image to be scanned. The program follows these steps:

1. **Preprocessing:**
   - The image is loaded and processed using **OpenCV (cv2)**.
   - White margins are removed (binarization and background elimination).

2. **QR Code Structure Analysis:**
   - The **module size** is determined by counting black pixels in the first row and dividing by 7 (since a finder pattern is always 7 modules wide).
   - Knowing the module size, the image dimensions are divided accordingly to determine the QR code version.
   - A binary matrix is generated by averaging pixel values within each module.

3. **Decoding the QR Code:**
   - A list of coordinates containing key QR elements is created (finder patterns, alignment patterns, etc.) to avoid interference.
   - The **format information** is extracted to determine the applied mask.
   - The mask is removed using the standard **QR decoding formula**.
   - The first 4 bits (from bottom-right, moving upward) indicate the **encoding mode**.
   - The next 8 bits represent the **message length**.
   - The message is extracted by grouping bits into 8-bit ASCII characters.

**Example Output:** Decoded text from `qr_link.png`
<img src=https://github.com/neica200/Qr_reader_and_writer/blob/main/qr_link.png height="300px">
![image](https://github.com/user-attachments/assets/86a10c1a-1c6f-4bd0-9980-00aa600e4bbe)
---

## **References**
- **How QR Codes Work:**  
  - https://www.thonky.com/qr-code-tutorial/introduction  
  - https://www.youtube.com/watch?v=142TGhaTMtI  
  - https://www.nayuki.io/page/creating-a-qr-code-step-by-step4  
- **Image Processing:**  
  - https://docs.opencv.org/4.x/d6/d00/tutorial_py_root.html  
  - https://medium.com/@tharindad7/image-binarization-in-a-nutshell-b40b63c0228e
